---
sidebar: sidebar 
permalink: vmware/vmw-gcp-gcve-migrate-veeam.html 
keywords: gcp, gcve, gcnv, migrate , dr, disaster recovery, veeam, replication, proxy, re-ip 
summary: 目前使用 Veeam 满足数据保护需求的客户可以继续使用该解决方案将工作负载迁移到 GCVE，并享受Google Cloud NetApp Volumes NFS 数据存储区带来的好处。 
---
= 使用 Veeam Replication 功能将虚拟机迁移到 Google Cloud VMware Engine 上的Google Cloud NetApp Volumes NFS 数据存储区
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
目前使用 Veeam 满足数据保护需求的客户可以继续使用该解决方案将工作负载迁移到 GCVE，并享受Google Cloud NetApp Volumes NFS 数据存储区带来的好处。



== 概述

利用 Veeam Replication 功能可以将 VMware vSphere 上运行的虚拟机工作负载迁移到 Google Cloud VMware Engine (GCVE)。

本文档提供了使用Google Cloud NetApp Volumes、Veeam 和 Google Cloud VMware Engine (GCVE) 设置和执行 VM 迁移的分步方法。

image:gcp-migration-veeam-001.png["Veeam VM 复制架构"]



== 假设

本文档假设您已安装 Google Cloud VPN 或 Cloud Interconnect 或其他网络选项，以建立从现有 vSphere 服务器到 Google Cloud VMware Engine 的网络连接。


NOTE: 将本地数据中心连接到 Google Cloud 有多种选择，因此我们无法在本文档中概述特定的工作流程。请参阅link:https://cloud.google.com/network-connectivity/docs/how-to/choose-product["Google Cloud 文档"]以找到适当的本地到 Google 连接方法。



== 部署迁移解决方案



=== 解决方案部署概述

. 确保Google Cloud NetApp Volumes的 NFS 数据存储已安装在 GCVE vCenter 上。
. 确保 Veeam Backup Recovery 部署在现有 VMware vSphere 环境中
. 创建复制作业以开始将虚拟机复制到 Google Cloud VMware Engine 实例。
. 执行 Veeam 复制作业的故障转移。
. 在 Veeam 上执行永久故障转移。




=== 部署详情



==== 确保Google Cloud NetApp Volumes中的 NFS 数据存储已安装在 GCVE vCenter 上

登录 GCVE vCenter 并确保有足够空间的 NFS 数据存储可用。如果没有，请参阅link:vmw-gcp-gcve-nfs-ds-overview.html["将NetApp卷挂载为 GCVE 上的 NFS 数据存储"]



==== 确保 Veeam Backup Recovery 部署在现有 VMware vSphere 环境中

请参考link:https://helpcenter.veeam.com/docs/backup/vsphere/replication_components.html?ver=120["Veeam 复制组件"]安装所需组件的文档。



==== 创建复制作业以开始将虚拟机复制到 Google Cloud VMware Engine 实例。

本地 vCenter 和 GCVE vCenter 都需要在 Veeam 中注册。link:https://helpcenter.veeam.com/docs/backup/vsphere/replica_job.html?ver=120["设置 vSphere VM 复制作业"]这是一个视频，解释了如何link:https://youtu.be/uzmKXtv7EeY["配置复制作业"]。


NOTE: 副本虚拟机可以具有与源虚拟机不同的 IP，也可以连接到不同的端口组。欲了解更多详情，请查看上面的视频。



==== 执行 Veeam 复制作业的故障转移

要迁移虚拟机，请执行link:https://helpcenter.veeam.com/docs/backup/vsphere/performing_failover.html?ver=120["执行故障转移"]



==== 在 Veeam 上执行永久故障转移。

要将 GCVE 视为新的源环境，请执行link:https://helpcenter.veeam.com/docs/backup/vsphere/permanent_failover.html?ver=120["永久故障转移"]



== 此解决方案的优势

* 现有的 Veeam 备份基础架构可用于迁移。
* Veeam Replication 允许更改目标站点上的 VM IP 地址。
* 能够重新映射 Veeam 外部复制的现有数据（例如从BlueXP复制的数据）
* 能够在目标站点上指定不同的网络端口组。
* 可以指定虚拟机的启动顺序。
* 利用 VMware 变更块跟踪来最大限度地减少通过 WAN 发送的数据量。
* 能够执行复制的前脚本和后脚本。
* 能够执行快照的前脚本和后脚本。

