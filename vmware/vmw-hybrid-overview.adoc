---
sidebar: sidebar 
permalink: vmware/vmw-hybrid-overview.html 
keywords: NetApp Solutions, hybrid, multicloud, multi cloud, enterprise hybrid cloud, hyperscalers, vmware 
summary:  
---
= NetApp与 VMware 的混合多云概述
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
大多数 IT 组织都遵循混合云优先方法。这些组织正处于转型阶段，客户正在评估其当前的 IT 环境，然后根据评估和发现练习将其工作负载迁移到云端。

客户迁移到云的因素可能包括弹性和爆发、数据中心退出、数据中心整合、生命周期终止场景、合并、收购等。迁移的原因可能因每个组织及其各自的业务优先级而异。当迁移到混合云时，选择正确的云存储对于释放云部署和弹性的威力非常重要。



== 公共云中的 VMware Cloud 选项

本节介绍每个云提供商如何在各自的公共云产品中支持 VMware 软件定义数据中心 (SDDC) 和/或 VMware Cloud Foundation (VCF) 堆栈。



=== Azure VMware 解决方案

Azure VMware 解决方案是一种混合云服务，允许在 Microsoft Azure 公共云中完全运行 VMware SDDC。 Azure VMware 解决方案是完全由 Microsoft 管理和支持的第一方解决方案，并由 VMware 利用 Azure 基础架构进行了验证。这意味着，当部署 Azure VMware 解决方案时，客户可以获得 VMware 的 ESXi 用于计算虚拟化、vSAN 用于超融合存储以及 NSX 用于网络和安全，同时利用 Microsoft Azure 的全球影响力、一流的数据中心设施以及靠近丰富的原生 Azure 服务和解决方案生态系统的优势。



=== AWS 上的 VMware Cloud

VMware Cloud on AWS 将 VMware 的企业级 SDDC 软件引入 AWS 云，并优化了对原生 AWS 服务的访问。  VMware Cloud on AWS 由 VMware Cloud Foundation 提供支持，集成了 VMware 的计算、存储和网络虚拟化产品（VMware vSphere、VMware vSAN 和 VMware NSX）以及 VMware vCenter Server 管理，并针对专用、弹性、裸机 AWS 基础架构上运行进行了优化。



=== Google Cloud VMware 引擎

Google Cloud VMware Engine 是一款基础架构即服务 (IaaS) 产品，它基于 Google Cloud 高性能可扩展基础架构和 VMware Cloud Foundation 堆栈（VMware vSphere、vCenter、vSAN 和 NSX-T）构建。此服务可快速迁移至云端，将现有 VMware 工作负载从本地环境无缝迁移或扩展到 Google Cloud Platform，无需承担重构应用程序或重新调整运维的成本、精力或风险。这是一项由 Google 销售和支持的服务，并与 VMware 密切合作。


NOTE: SDDC 私有云和NetApp Cloud Volumes 主机托管以最小的网络延迟提供最佳性能。



== 你可知道？

无论使用哪种云，部署 VMware SDDC 时，初始集群都包含以下产品：

* VMware ESXi 主机用于计算虚拟化，并使用 vCenter Server Appliance 进行管理
* VMware vSAN 超融合存储，整合了每个 ESXi 主机的物理存储资产
* VMware NSX 用于虚拟网络和安全，并使用 NSX Manager 集群进行管理




== 存储配置

对于计划托管存储密集型工作负载并在任何云托管 VMware 解决方案上进行扩展的客户，默认的超融合基础架构要求扩展应同时在计算和存储资源上进行。

通过与NetApp Cloud Volumes（例如Azure NetApp Files、 Amazon FSx ONTAP、 Cloud Volumes ONTAP （适用于所有三大超大规模服务器）以及适用于 Google Cloud 的Google Cloud NetApp Volumes ）集成，客户现在可以选择单独扩展其存储，并且仅根据需要向 SDDC 集群添加计算节点。



=== 注：

* VMware 不建议不平衡的集群配置，因此扩展存储意味着添加更多主机，这意味着更多的 TCO。
* 仅可以有一个 vSAN 环境。因此，所有存储流量都将直接与生产工作负载竞争。
* 没有提供多个性能层来满足应用程序要求、性能和成本的选项。
* 建立在集群主机之上的 vSAN 的存储容量很容易达到极限。使用NetApp Cloud Volumes 扩展存储以托管活动数据集或将较冷的数据分层到持久存储。


Azure NetApp Files、 Amazon FSx ONTAP、 Cloud Volumes ONTAP （三大超大规模服务器均可使用）以及适用于 Google Cloud 的Google Cloud NetApp Volumes可与来宾虚拟机结合使用。这种混合存储架构由保存客户操作系统和应用程序二进制数据的 vSAN 数据存储组成。应用程序数据通过基于来宾的 iSCSI 启动器或 NFS/SMB 挂载附加到虚拟机，这些挂载分别与Amazon FSx ONTAP、Cloud Volume ONTAP、 Azure NetApp Files和 Google Cloud 的Google Cloud NetApp Volumes直接通信。这种配置使您可以轻松克服存储容量方面的挑战，就像使用 vSAN 一样，可用的空闲空间取决于所使用的松弛空间和存储策略。

让我们考虑一下 VMware Cloud on AWS 上的三节点 SDDC 集群：

* 三节点 SDDC 的总原始容量 = 31.1TB（每个节点大约 10TB）。
* 添加其他主机之前需要维护的松弛空间 = 25% = (.25 x 31.1TB) = 7.7TB。
* 扣除剩余空间后的可用原始容量 = 23.4TB
* 可用的有效空闲空间取决于所应用的存储策略。
+
例如：

+
** RAID 0 = 有效可用空间 = 23.4TB（可用原始容量/1）
** RAID 1 = 有效可用空间 = 11.7TB（可用原始容量/2）
** RAID 5 = 有效可用空间 = 17.5TB（可用原始容量/1.33）




因此，使用NetApp Cloud Volumes 作为客户机连接存储将有助于扩展存储和优化 TCO，同时满足性能和数据保护要求。


NOTE: 在撰写本文档时，客舱内存储是唯一可用的选项。



=== 需要记住的要点

* 在混合存储模型中，将第 1 层或高优先级工作负载放置在 vSAN 数据存储上，以满足任何特定的延迟要求，因为它们是主机本身的一部分并且在附近。对于任何可以接受事务延迟的工作负载虚拟机，请使用客户机内机制。
* 使用NetApp SnapMirror技术将工作负载数据从本地ONTAP系统复制到Cloud Volumes ONTAP或Amazon FSx ONTAP ，以简化使用块级机制的迁移。这不适用于Azure NetApp Files和Google Cloud NetApp Volumes。要将数据迁移到Azure NetApp Files或Google Cloud NetApp Volumes，请根据所使用的文件协议使用NetApp XCP、 BlueXP Copy and Sync、rysnc 或 robocopy。
* 测试表明，从相应的 SDDC 访问存储时会有 2-4ms 的额外延迟。在映射存储时，将此额外的延迟考虑进应用程序要求中。
* 为了在测试故障转移和实际故障转移期间挂载来宾连接的存储，请确保重新配置 iSCSI 启动器、为 SMB 共享更新 DNS、并在 fstab 中更新 NFS 挂载点。
* 确保虚拟机内部的 Microsoft 多路径 I/O (MPIO)、防火墙和磁盘超时注册表设置配置正确。



NOTE: 这仅适用于来宾连接的存储。



== NetApp云存储的优势

NetApp云存储具有以下优势：

* 通过独立于计算扩展存储来提高计算到存储的密度。
* 允许您减少主机数量，从而降低总体 TCO。
* 计算节点故障不会影响存储性能。
* Azure NetApp Files的卷重塑和动态服务级别功能允许您通过调整稳定状态工作负载的大小来优化成本，从而防止过度配置。
* Cloud Volumes ONTAP的存储效率、云分层和实例类型修改功能允许以最佳方式添加和扩展存储。
* 防止过度配置存储资源，仅在需要时添加。
* 高效的 Snapshot 副本和克隆允许您快速创建副本而不会对性能产生任何影响。
* 通过使用 Snapshot 副本的快速恢复来帮助应对勒索软件攻击。
* 提供高效的基于增量块传输的区域灾难恢复和跨区域的集成备份块级别，提供更好的 RPO 和 RTO。




== 假设

* 启用SnapMirror技术或其他相关数据迁移机制。有许多连接选项，从本地到任何超大规模云。使用适当的路径并与相关的网络团队合作。
* 在撰写本文档时，客舱内存储是唯一可用的选项。



NOTE: 与NetApp解决方案架构师和相应的超大规模云架构师合作，规划和确定存储以及所需的主机数量。  NetApp建议在使用Cloud Volumes ONTAP大小调整器之前先确定存储性能要求，以确定存储实例类型或具有正确吞吐量的适当服务级别。



== 详细架构

从高层次的角度来看，该架构（如下图所示）涵盖了如何使用NetApp Cloud Volumes ONTAP、 Google Cloud NetApp Volumes for Google Cloud 和Azure NetApp Files作为额外的客户机存储选项，实现跨多个云提供商的混合多云连接和应用程序可移植性。

image:ehc-architecture.png["企业混合云架构"]
